const fs = require('fs');
const path = require('path');

const jsonDir = path.join(process.cwd(), 'static', 'json');
let entries = [];
try {
  if (fs.existsSync(jsonDir)) {
    const names = fs.readdirSync(jsonDir).filter((n) => n.endsWith('.json'));
    entries = names.map((name) => ({
      name,
      absPath: path.join(jsonDir, name),
      publicUrl: `/json/${name}`,
    }));
  }
} catch (err) {
  console.warn('Failed to list JSON directory', err);
}

const outPath = path.join(process.cwd(), 'src', 'components', 'RacingLineFiles', 'fileList.ts');
const content = `// this file is auto-generated by scripts/generate-racing-line-list.js

const entries = ${JSON.stringify(entries, null, 2)};

export default entries;
`;

fs.writeFileSync(outPath, content);
console.log(`Wrote ${entries.length} entries to ${outPath}`);
